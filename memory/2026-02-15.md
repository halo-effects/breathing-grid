# 2026-02-15

## Aster Bot Crash-Loop Investigation (~4:00 AM PST)
- Bot halted with "3+ consecutive API errors" and entered crash-loop
- Investigated: ALL Aster API endpoints working fine (public + authenticated + order place/cancel)
- **Root cause is NOT Aster outage or IP block** — it's something in the bot's trading logic
- Suspect: adaptive params were at floor values (TP=0.6%, deviation=1.2%) which may produce tiny order sizes hitting $5 minimum notional
- Aster minimum notional: $5.0 per order (confirmed via error code -4164)
- Bot error logging is too sparse — only logs "3+ consecutive API errors" without the actual error details
- **TODO**: Add actual error message logging to halt output in aster_trader.py
- **TODO**: Investigate whether small adaptive params → sub-$5 notional orders → cascade failures
- Open positions at time of halt: LONG #59 (1.27 qty @ $31.54 avg), SHORT #63 (0.43 qty @ $30.855)
- Equity: $335.93, PnL: +$43.96 (+15.06%)

## API Test Scripts Created
- `trading/test_api.ps1` — public endpoint checks
- `trading/test_api2.py` — authenticated endpoint checks  
- `trading/test_api3.py` — order place/cancel test
- These can be reused for future diagnostics

## Bot Code Fixes Applied
- Auto-clear transient halts (API errors) on restart — prevents crash-loop when connectivity returns
- Better ping error logging — now prints actual exception
- Edit location: `trading/aster_trader.py` load_state() and ping() methods

## Coin Scanner / Auto-Rotation System Built (~4:22 AM)
- Brett requested system to find optimal coins for DCA bot and rotate automatically
- **Two-tier architecture** (Brett's idea to avoid expensive backtests on all coins):
  - Tier 1 (`trading/coin_scanner_t1.py`): Cheap filter — ADX, ATR%, Hurst, SMA crosses, volume. Scans ALL Aster pairs (275 found). Seconds per coin.
  - Tier 2 (`trading/coin_scanner_t2.py`): Deep scan — full 14-day 5m backtest with our params. Only runs on Tier 1 shortlist (~13 coins).
  - Runner: `trading/run_scanner.py` — ties both tiers, outputs recommendation
- **First scan results**: BERA/USDT scored #1 (62.9) vs HYPE (46.2), 0.73% daily ROI, 5.9 deals/day
- ZAMA/USDT #2 (59.5), then HYPE #3
- **Known issue**: Hurst calculation broken (all showing 1.0+), fix in progress
- Rotation threshold: new coin must score >20% better to recommend switch
- Output files: `trading/live/scanner_t1.json`, `scanner_t2.json`, `scanner_recommendation.json`

## Multi-Asset Vision (discussed)
- Brett wants to eventually split capital across 2-3 top-scored coins (diversification)
- Similar to WhiteHatFX approach but data-driven selection
- Would require refactoring aster_trader.py to manage multiple symbols
- Phase 2 project — scanner + rotation is Phase 1

## Scanner Fixes & Validation (~4:49 AM)
- Hurst calculation fixed (was broken at 1.0+, now 0.5-0.6 range)
- BERA validation: signal looked good technically but only 33 days old
- Brett flagged pump-and-dump risk for new coins — correct instinct

## Maturity Filters Added & Tuned (~5:06-5:24 AM)
- First attempt: 50% price swing, 80-day age → filtered EVERYTHING (even HYPE at 87% swing)
- **Lesson**: crypto swings much larger than traditional markets — thresholds must reflect this
- Final tuned thresholds: age 60+ days, price swing 120%, volume spike 4x, $1M volume floor
- Results: 275 pairs → 8 passed maturity → 8 passed technical
- **HYPE confirmed #1** (52.9), ASTER #2 (46.1), DOGE #3 (41.2), SOL #4, ETH #5
- BERA/ZAMA correctly filtered out as too new

## Scanner Cron Job Active
- Job ID: b9571b56-5d72-4d25-b125-d834b12ea572
- Schedule: every 4h, America/Los_Angeles, announces to Brett
- TODO: optimize speed (maturity check takes ~15-20 min for 275 pairs)
- Unicode fix: added sys.stdout.reconfigure(encoding='utf-8') to scanner scripts

## Telegram Notifications Re-enabled (~4:39 AM)
- Changed TG_ENABLED = True in aster_trader.py line 28

## Directional Awareness Added (~6:10 AM)
- Brett noticed TRENDING was always 75/25 long/short regardless of trend direction
- Added SMA50-based trend direction detection in `detect_regime()`
- Directional regimes (TRENDING, MILD_TREND, DISTRIBUTION) now flip allocation when bearish
- Example: TRENDING▼ = 25/75 long/short (favors shorts in downtrend)
- status.json includes `trend_direction: "bullish"/"bearish"`
- Log output shows ▲/▼ after regime name
- Dashboard + product page updated to reflect feature
- **Confirmed working live**: TRENDING▼ showing L:25%/S:75%

## Dashboard & Product Page Updates (~6:15-6:27 AM)
- Dashboard: regime badge shows ▲/▼ arrows with color, allocation shows direction-adjusted
- Product page: Layer 3 updated, allocation table shows bullish vs bearish, evolution timeline updated
- Brett asked about multi-coin dashboard vision — presented plan for portfolio view, coin selector panel, per-coin cards, rotation history
- Awaiting Brett's decision: build forward-looking mockups now vs wait for actual multi-coin bot refactor

## Multi-Coin Portfolio Manager Built (~6:45 AM)
- `trading/portfolio_manager.py` — PortfolioManager + CoinSlot classes
- `trading/run_portfolio.py` — entry point (--dry-run, --max-coins, --leverage, --capital)
- Up to 3 coins simultaneously, scanner-driven selection, score-proportional allocation
- 10% capital reserve, 15% minimum per coin, 20% improvement threshold for rotation
- Graceful wind-down: 2h timeout, 4h minimum hold time
- Backward compatible — single-coin run_aster.py still works, separate state files
- Dashboard v3.0: auto-detects portfolio vs single-coin mode
- Product page: Layer 5 (Intelligent Portfolio Management), Gen 4 evolution entry

## Git Push to GitHub (~6:51 AM)
- First push had issues: no git config, no remote, PAT token in sync_dashboard.ps1
- Added .gitignore (node_modules, __pycache__, data, results, state files, logs, secrets)
- Removed sync_dashboard.ps1 from tracking (contained PAT)
- Force pushed to origin/main (replaced old repo content)
- Git config: user=Gee Gee, email=geegee@haloeffects.net

## Capital Concern for Multi-Coin Mode
- $335 split 3 ways after 10% reserve = ~$100-115 per coin
- Base order at 4% = ~$4-5, right at Aster's $5 minimum notional
- Recommended max-coins=2 for safety: HYPE ~55%, ASTER ~45%
- Brett agreed to switch to portfolio mode, awaiting his decision on 2 vs 3 coins

## GitHub Pages Setup (~7:13 AM)
- Brett reported https://halo-effects.github.io/breathing-grid/ shows 404
- Root cause: no index.html at root or /docs — Pages had nowhere to serve from
- Created `docs/` folder, copied product page there, pushed to main
- GitHub Pages still needs to be ENABLED in repo settings → Settings > Pages > Deploy from branch > main > /docs
- Brett needs to do this (or I can via browser) — API returned 404 (Pages not configured)

## Bot Status at 7:00 AM
- Running healthy, ACCUMULATION regime, bearish trend
- Equity: $334.33, PnL: +14.51%, drawdown: 0.7%
- Long #59 (2 SOs, avg $31.19), Short #64 (0 SOs, entry $30.80)
- Adaptive TP/Dev at floor: 0.60% / 1.20% (low ATR period)
- Portfolio manager test run crashed during scanner phase (exec `grand-at` code 1) — live single-coin bot unaffected

## GitHub Pages Fully Configured (~7:16-7:50 AM)
- Brett away, asked me to handle it
- Used browser tool to change GitHub Pages source from `/ (root)` to `/docs` in repo settings
- Added AIT pulsing SVG logo + "Adaptive Intelligence Trading" text to fixed header on product page
- Added "Live Dashboard" button (green gradient) to header, linking to `dashboard.html`
- Added "Asset Selection" row to comparison table: "Manual — single coin, hope it works" vs "Scanner-driven multi-coin portfolio with automatic rotation"
- Dashboard 404'd because data files weren't in `docs/data/` — fixed sync script
- Updated `trading/sync_dashboard.ps1` to push data into `docs/data/` (was pushing to repo root)
- Deleted stale sync repo clone (`$TEMP\ait-dashboard-sync`) and re-triggered task
- Confirmed working: dashboard loads with live data at https://halo-effects.github.io/breathing-grid/dashboard.html
- Product page live at: https://halo-effects.github.io/breathing-grid/
- Sync task (`AIT_DashboardSync`) runs every 2 min, pushes status.json, trades.csv, portfolio_status.json
- **Note**: sync_dashboard.ps1 contains PAT in plaintext and is in .gitignore — should rotate/secure eventually

## Dashboard Mobile Responsiveness (~12:27 PM)
- Brett requested mobile-friendly dashboard
- Added comprehensive media queries for ≤600px and ≤380px breakpoints
- Key fixes: header stacks vertically, 2-col stat cards, single-col charts, no hover zoom on touch, scrollable tables, tighter padding
- Updated both `docs/dashboard.html` (GitHub Pages) and `trading/live/dashboard.html` (local)
- Git push conflicted with sync task (both push to same repo) — resolved with stash + rebase

## Scanner Cron Timing Out
- Scanner cron runs every 4h but only gets 5 min runtime — not enough to scan 275 pairs + T2 backtests
- Keeps reporting "almost there" or "this will take a while" without completing
- TODO: either increase cron timeout or optimize scanner speed (parallel requests, caching)

## Product Page Mobile Responsive (~12:33 PM)
- Added comprehensive mobile breakpoints matching dashboard treatment
- Fixed header: logo shrinks, title responsive, button compact on mobile
- Added logo + title clickable links back to product page on both dashboard and product page

## Scanner Cron Timeout Issue (Ongoing)
- Scanner cron (every 4h) consistently times out at 5 min — can't finish 275 pairs
- Happened at 8:05 AM, 12:05 PM, 4:05 PM — all failed to complete
- Need to either: increase cron timeout, optimize scanner (parallel/caching), or reduce pair count
- Not urgent — bot runs fine on HYPE, scanner just can't produce fresh recommendations

## Git Push Conflicts with Sync Task (Recurring)
- `AIT_DashboardSync` task pushes to same repo every 2 min
- Manual pushes frequently rejected — need stash + pull --rebase + stash pop workflow
- Consider: pause sync task during dev sessions, or use separate branches

## Afternoon Bot Status (~5:44 PM)
- Price dropped to ~$30.16, equity $327.92, PnL +12.3%
- Long #59 underwater: 2.99 qty @ $31.19 avg (2 SOs filled), ~$3 unrealized loss
- Short #67 profiting from the drop — dual-tracking offsetting as designed
- Drawdown peaked ~2% — well within limits
- Brett asked about PnL being down — confirmed unrealized loss on long position

## PowerShell Escaping Issues (Recurring)
- `$_` gets eaten in inline powershell via exec tool
- Workaround: write .ps1 scripts and run with -File flag
- Created `trading/restart_bot.ps1` for reliable bot restarts

## Evening Updates (~7:00-7:40 PM)
- Fixed Live Dashboard button on product page to open in new tab (`target="_blank"`)
- **Built Coin Scanner section for dashboard** — Brett approved the design
  - Filter funnel visualization: 275 pairs → mature → backtested (badge pipeline)
  - Recommendation banner: HOLD (green) or ROTATE (amber) with score comparison
  - Maturity filter breakdown: 5 stat cards showing rejection reasons (too new, price swing, low volume, etc.)
  - Full rankings table: score, daily ROI, deals/day, win rate, max DD, profit, avg SOs, friendly regimes
  - Active coin highlighted with blue "ACTIVE" badge
  - Last scan timestamp with relative time display
  - Refreshes every 5 min (scanner runs every 4h)
- Updated `sync_dashboard.ps1` to push scanner JSON files (recommendation, t1, t2) to `docs/data/`
- Copied updated dashboard + scanner data to `docs/` for next sync cycle
- Renamed "Deals/Day" → "Cycles/Day" with tooltip explanation
- Added "Filtered Out" header + threshold labels to maturity filter breakdown cards
- Changed trade history default page size from 25 → 10

## AIT Productization Thought Experiment (~8:20 PM)
- Brett asked: what if we sell the bot as a product? Lump sum lifetime access.
- Architecture designed: Central Server + customer-local bots + per-customer dashboards
- Customer never shares Aster credentials — bot runs on their hardware
- Central handles: scanner (shared), strategy updates, license mgmt, dashboard hosting
- API spec drafted: `/auth`, `/scanner`, `/strategy`, `/data`, `/updates`, `/dashboard`
- Stored full spec in `projects/ait-product/api-spec-v0.1.md`
- **Customer cap analysis**:
  - Edge erosion risk = too many bots on same coin/exchange creating order clustering
  - Conservative cap: 50 customers × $50K max = $2.5M total footprint (~25% HYPE volume) = $150K revenue
  - Aggressive cap: 100 customers × $100K max = $5M footprint = $500K revenue (needs coin diversification)
  - Key mitigations: parameter jitter, staggered rotation, coin diversification enforcement, multi-exchange expansion
  - Real cap is total AIT capital per coin per exchange, not customer count
- Brett wants to circle back once we have more live performance data
- **Tiered pricing model** added: 10% of max capital (Starter $500 → Whale $10K)
  - Global pool cap: $2.5M total reserved capital
  - Revenue ~$250K regardless of customer mix
  - ~29 day breakeven at every tier
  - Enforcement: degrade scanner access if over cap
  - Expansion via new exchanges increases pool cap
  - Full spec: `projects/ait-product/api-spec-v0.1.md`
